<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Slow Transients Pipeline Prototype: /home/lucas/skadev/FastImaging/src/stp/sourcefind/fitting.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="science_data_processor_logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Slow Transients Pipeline Prototype
   </div>
   <div id="projectbrief">Component of the Science Data Processor being developed in the context of the Square Kilometre Array international project, which provides fast snapshot imaging, object detection and cataloguing for the identification of astrophysical image-plane transients.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_71906deff00c706128a95d3938125d0a.html">stp</a></li><li class="navelem"><a class="el" href="dir_389da9bd1b138630925c64dfd5b54283.html">sourcefind</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">fitting.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="fitting_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#ifndef FITTING_H</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#define FITTING_H</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;../types.h&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;armadillo&gt;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;ceres/ceres.h&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacestp.html">stp</a> {</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="structstp_1_1_bounding_box.html">   18</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structstp_1_1_bounding_box.html">BoundingBox</a> {</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="structstp_1_1_bounding_box.html#a42675b807603afceddf023780b44ee15">   19</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstp_1_1_bounding_box.html#a42675b807603afceddf023780b44ee15">top</a>;</div><div class="line"><a name="l00020"></a><span class="lineno"><a class="line" href="structstp_1_1_bounding_box.html#a42ffd05da73f34a9b92d67c988157b0b">   20</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstp_1_1_bounding_box.html#a42ffd05da73f34a9b92d67c988157b0b">bottom</a>;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="structstp_1_1_bounding_box.html#ac14eb4f1efe47409b913fab82387af0e">   21</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstp_1_1_bounding_box.html#ac14eb4f1efe47409b913fab82387af0e">left</a>;</div><div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="structstp_1_1_bounding_box.html#a1ece3e9432bf6f727d960c03d95c620b">   22</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstp_1_1_bounding_box.html#a1ece3e9432bf6f727d960c03d95c620b">right</a>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structstp_1_1_bounding_box.html#a3e852371cfe56aa2e7d3d634369526a3">   29</a></span>&#160;    <a class="code" href="structstp_1_1_bounding_box.html#a3e852371cfe56aa2e7d3d634369526a3">BoundingBox</a>()</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;        : top(0)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        , bottom(0)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;        , left(0)</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;        , right(0)</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    {</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    }</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structstp_1_1_bounding_box.html#aae17bfc0c907cc50aa9e1b19ece90ab0">   45</a></span>&#160;    <a class="code" href="structstp_1_1_bounding_box.html#aae17bfc0c907cc50aa9e1b19ece90ab0">BoundingBox</a>(<span class="keywordtype">int</span> in_top, <span class="keywordtype">int</span> in_bottom, <span class="keywordtype">int</span> in_left, <span class="keywordtype">int</span> in_right)</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;        : top(in_top)</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;        , bottom(in_bottom)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        , left(in_left)</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        , right(in_right)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    }</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structstp_1_1_bounding_box.html#a5e1b106dcd0dcf1bae545155ab9650fc">   58</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstp_1_1_bounding_box.html#a5e1b106dcd0dcf1bae545155ab9650fc">get_width</a>()</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    {</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keywordflow">return</span> right - left + 1;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structstp_1_1_bounding_box.html#a1b25cedf5d232bbd501ecd93108157a5">   68</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstp_1_1_bounding_box.html#a1b25cedf5d232bbd501ecd93108157a5">get_height</a>()</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">return</span> bottom - top + 1;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;};</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structstp_1_1_gaussian2d_fit.html">   84</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structstp_1_1_gaussian2d_fit.html">Gaussian2dFit</a> {</div><div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structstp_1_1_gaussian2d_fit.html#a70741214b36229ea1f4e5332442f10b1">   85</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structstp_1_1_gaussian2d_fit.html#a70741214b36229ea1f4e5332442f10b1">amplitude</a>;</div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="structstp_1_1_gaussian2d_fit.html#a749842ca57caedb0050961d4edda463b">   86</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structstp_1_1_gaussian2d_fit.html#a749842ca57caedb0050961d4edda463b">x_centre</a>;</div><div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structstp_1_1_gaussian2d_fit.html#a06c0a70f9f5fb23c6ea7cb55fba33527">   87</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structstp_1_1_gaussian2d_fit.html#a06c0a70f9f5fb23c6ea7cb55fba33527">y_centre</a>;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structstp_1_1_gaussian2d_fit.html#a56010c0b1910b15f716ec079f9e96721">   88</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structstp_1_1_gaussian2d_fit.html#a56010c0b1910b15f716ec079f9e96721">semimajor</a>;</div><div class="line"><a name="l00089"></a><span class="lineno"><a class="line" href="structstp_1_1_gaussian2d_fit.html#ab516face3c6a2aef1eaae187cc517b8c">   89</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structstp_1_1_gaussian2d_fit.html#ab516face3c6a2aef1eaae187cc517b8c">semiminor</a>;</div><div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structstp_1_1_gaussian2d_fit.html#a7f08f1d195d56ec03896c22219923ea1">   90</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structstp_1_1_gaussian2d_fit.html#a7f08f1d195d56ec03896c22219923ea1">theta</a>;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00097"></a><span class="lineno"><a class="line" href="structstp_1_1_gaussian2d_fit.html#ad4a6ecef61116e3d841a99875f10dc3b">   97</a></span>&#160;    <a class="code" href="structstp_1_1_gaussian2d_fit.html#ad4a6ecef61116e3d841a99875f10dc3b">Gaussian2dFit</a>()</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        : amplitude(0.0)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        , x_centre(0.0)</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        , y_centre(0.0)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        , semimajor(0.0)</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        , semiminor(0.0)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        , theta(0.0)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno"><a class="line" href="structstp_1_1_gaussian2d_fit.html#a5c7767669adefb245374ec6c49a47e1c">  117</a></span>&#160;    <a class="code" href="structstp_1_1_gaussian2d_fit.html#a5c7767669adefb245374ec6c49a47e1c">Gaussian2dFit</a>(<span class="keywordtype">double</span> in_amplitude, <span class="keywordtype">double</span> in_x_centre, <span class="keywordtype">double</span> in_y_centre, <span class="keywordtype">double</span> in_semimajor, <span class="keywordtype">double</span> in_semiminor, <span class="keywordtype">double</span> in_theta)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        : amplitude(in_amplitude)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        , x_centre(in_x_centre)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        , y_centre(in_y_centre)</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        , semimajor(in_semimajor)</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        , semiminor(in_semiminor)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        , theta(in_theta)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    }</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordtype">double</span> evaluate_point(<span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;};</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;</div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="classstp_1_1_gaussian_residual.html">  144</a></span>&#160;<span class="keyword">class </span><a class="code" href="classstp_1_1_gaussian_residual.html">GaussianResidual</a> {</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00153"></a><span class="lineno"><a class="line" href="classstp_1_1_gaussian_residual.html#a23d8c1a409da25e6cb3e3093469d6b3a">  153</a></span>&#160;    <a class="code" href="classstp_1_1_gaussian_residual.html#a23d8c1a409da25e6cb3e3093469d6b3a">GaussianResidual</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> data, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        : _data(data)</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        , _x(x)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        , _y(y)</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00167"></a><span class="lineno"><a class="line" href="classstp_1_1_gaussian_residual.html#a69a862992ba9461ccda9ffaaade70916">  167</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classstp_1_1_gaussian_residual.html#a69a862992ba9461ccda9ffaaade70916">operator()</a>(<span class="keyword">const</span> T* <span class="keyword">const</span> params, T* residual)<span class="keyword"> const</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        <span class="keyword">const</span> T&amp; amplitude = params[0];</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keyword">const</span> T&amp; x_centre = params[1];</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="keyword">const</span> T&amp; y_centre = params[2];</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keyword">const</span> T&amp; x_stddev = params[3];</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keyword">const</span> T&amp; y_stddev = params[4];</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keyword">const</span> T&amp; theta = params[5];</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">// Auxiliary calculations for 2D gaussian function</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keyword">const</span> T cost = cos(theta);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="keyword">const</span> T cost2 = cost * cost;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keyword">const</span> T sint = sin(theta);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keyword">const</span> T sint2 = sint * sint;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keyword">const</span> T sin2t = sin(2.0 * theta);</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keyword">const</span> T xstd2 = x_stddev * x_stddev;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keyword">const</span> T ystd2 = y_stddev * y_stddev;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keyword">const</span> T a = 0.5 * ((cost2 / xstd2) + (sint2 / ystd2));</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keyword">const</span> T b = 0.5 * ((sin2t / xstd2) - (sin2t / ystd2));</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        <span class="keyword">const</span> T c = 0.5 * ((sint2 / xstd2) + (cost2 / ystd2));</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keyword">const</span> T xdiff = _x - x_centre;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keyword">const</span> T ydiff = _y - y_centre;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="comment">// Compute residual</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        residual[0] = amplitude * exp(-(a * xdiff * xdiff</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                      + b * xdiff * ydiff</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                                      + c * ydiff * ydiff))</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            - _data;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> _data;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> _x;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> _y;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;};</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;</div><div class="line"><a name="l00211"></a><span class="lineno"><a class="line" href="classstp_1_1_gaussian_all_residuals.html">  211</a></span>&#160;<span class="keyword">class </span><a class="code" href="classstp_1_1_gaussian_all_residuals.html">GaussianAllResiduals</a> {</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00221"></a><span class="lineno"><a class="line" href="classstp_1_1_gaussian_all_residuals.html#acd0a39caab3be9fa027f4b4d4701ab82">  221</a></span>&#160;    <a class="code" href="classstp_1_1_gaussian_all_residuals.html#acd0a39caab3be9fa027f4b4d4701ab82">GaussianAllResiduals</a>(<span class="keyword">const</span> arma::Mat&lt;real_t&gt;&amp; data, <span class="keyword">const</span> arma::Mat&lt;int&gt;&amp; label_map, <span class="keyword">const</span> <a class="code" href="structstp_1_1_bounding_box.html">BoundingBox</a>&amp; box, <span class="keyword">const</span> <span class="keywordtype">int</span> label_idx)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        : _data(data)</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        , _label_map(label_map)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        , _label_idx(label_idx)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        , _box(box)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div><div class="line"><a name="l00236"></a><span class="lineno"><a class="line" href="classstp_1_1_gaussian_all_residuals.html#a5bb27d068d373fd741f7c091b6a3a9c1">  236</a></span>&#160;    <span class="keywordtype">bool</span> <a class="code" href="classstp_1_1_gaussian_all_residuals.html#a5bb27d068d373fd741f7c091b6a3a9c1">operator()</a>(<span class="keyword">const</span> T* <span class="keyword">const</span> params, T* residual)<span class="keyword"> const</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="keyword">    </span>{</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keyword">const</span> T&amp; amplitude = params[0];</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keyword">const</span> T&amp; x_centre = params[1];</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <span class="keyword">const</span> T&amp; y_centre = params[2];</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keyword">const</span> T&amp; x_stddev = params[3];</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keyword">const</span> T&amp; y_stddev = params[4];</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keyword">const</span> T&amp; theta = params[5];</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="comment">// Auxiliary calculations for 2D gaussian function</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keyword">const</span> T cost = cos(theta);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keyword">const</span> T cost2 = cost * cost;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keyword">const</span> T sint = sin(theta);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keyword">const</span> T sint2 = sint * sint;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keyword">const</span> T sin2t = sin(2.0 * theta);</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keyword">const</span> T xstd2 = x_stddev * x_stddev;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keyword">const</span> T ystd2 = y_stddev * y_stddev;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="keyword">const</span> T a = 0.5 * ((cost2 / xstd2) + (sint2 / ystd2));</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keyword">const</span> T b = 0.5 * ((sin2t / xstd2) - (sin2t / ystd2));</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;        <span class="keyword">const</span> T c = 0.5 * ((sint2 / xstd2) + (cost2 / ystd2));</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">#ifndef FFTSHIFT</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordtype">int</span> h_shift = (int)(_data.n_cols / 2);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordtype">int</span> v_shift = (int)(_data.n_rows / 2);</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="comment">// Compute residuals on positions where label map corresponds to label_idx</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = _box.left; i &lt;= _box.right; ++i) {</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = _box.top; j &lt;= _box.bottom; ++j) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> x = (double)(i);</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">double</span> y = (double)(j);</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="preprocessor">#ifdef FFTSHIFT</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; ii = i;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span>&amp; jj = j;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> ii = i &lt; h_shift ? i + h_shift : i - h_shift;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">int</span> jj = j &lt; v_shift ? j + v_shift : j - v_shift;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="keywordflow">if</span> (_label_map.at(jj, ii) != _label_idx) {</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                }</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keyword">const</span> T xdiff = x - x_centre;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                <span class="keyword">const</span> T ydiff = y - y_centre;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;                residual[0] = amplitude * exp(-(a * xdiff * xdiff</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                              + b * xdiff * ydiff</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                              + c * ydiff * ydiff))</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                    - (double)_data.at(jj, ii);</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                residual++;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        }</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    }</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keyword">const</span> arma::Mat&lt;real_t&gt;&amp; _data;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keyword">const</span> arma::Mat&lt;int&gt;&amp; _label_map;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> _label_idx;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keyword">const</span> <a class="code" href="structstp_1_1_bounding_box.html">BoundingBox</a> _box;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;};</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="classstp_1_1_gaussian_analytic.html">  305</a></span>&#160;<span class="keyword">class </span><a class="code" href="classstp_1_1_gaussian_analytic.html">GaussianAnalytic</a> : <span class="keyword">public</span> ceres::SizedCostFunction&lt;1, 6&gt; {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="classstp_1_1_gaussian_analytic.html#a4837f810e4883cf759c67ffe26940bc5">  314</a></span>&#160;    <a class="code" href="classstp_1_1_gaussian_analytic.html#a4837f810e4883cf759c67ffe26940bc5">GaussianAnalytic</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> data, <span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        : _data(data)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        , _x(x)</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        , _y(y)</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    {</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Evaluate(<span class="keywordtype">double</span> <span class="keyword">const</span>* <span class="keyword">const</span>* parameters, <span class="keywordtype">double</span>* residuals, <span class="keywordtype">double</span>** jacobians) <span class="keyword">const</span>;</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> _data;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> _x;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> _y;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;};</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="classstp_1_1_gaussian_analytic_all_residuals.html">  340</a></span>&#160;<span class="keyword">class </span><a class="code" href="classstp_1_1_gaussian_analytic_all_residuals.html">GaussianAnalyticAllResiduals</a> : <span class="keyword">public</span> ceres::CostFunction {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="classstp_1_1_gaussian_analytic_all_residuals.html#ab115cfb4f4d97ed3f879d296b0cef3b3">  352</a></span>&#160;    <a class="code" href="classstp_1_1_gaussian_analytic_all_residuals.html#ab115cfb4f4d97ed3f879d296b0cef3b3">GaussianAnalyticAllResiduals</a>(<span class="keyword">const</span> arma::Mat&lt;real_t&gt;&amp; data, <span class="keyword">const</span> arma::Mat&lt;int&gt;&amp; label_map, <span class="keyword">const</span> <a class="code" href="structstp_1_1_bounding_box.html">BoundingBox</a>&amp; box,</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> label_idx, <span class="keyword">const</span> <span class="keywordtype">int</span> num_residuals, <span class="keyword">const</span> <span class="keywordtype">int</span> parameter_block_size)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        : _data(data)</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        , _label_map(label_map)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        , _label_idx(label_idx)</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        , _box(box)</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    {</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="comment">// Set number of residuals</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        assert(num_residuals &gt; 0);</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        set_num_residuals(num_residuals);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="comment">// Set size of parameter block</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        assert(parameter_block_size &gt; 0);</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        mutable_parameter_block_sizes()-&gt;push_back(parameter_block_size);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="keyword">virtual</span> <span class="keywordtype">bool</span> Evaluate(<span class="keywordtype">double</span> <span class="keyword">const</span>* <span class="keyword">const</span>* parameters, <span class="keywordtype">double</span>* residuals, <span class="keywordtype">double</span>** jacobians) <span class="keyword">const</span>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="keyword">const</span> arma::Mat&lt;real_t&gt;&amp; _data;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keyword">const</span> arma::Mat&lt;int&gt;&amp; _label_map;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> _label_idx;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keyword">const</span> <a class="code" href="structstp_1_1_bounding_box.html">BoundingBox</a> _box;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;};</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;}</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* FITTING_H */</span><span class="preprocessor"></span></div><div class="ttc" id="structstp_1_1_gaussian2d_fit_html_a7f08f1d195d56ec03896c22219923ea1"><div class="ttname"><a href="structstp_1_1_gaussian2d_fit.html#a7f08f1d195d56ec03896c22219923ea1">stp::Gaussian2dFit::theta</a></div><div class="ttdeci">double theta</div><div class="ttdef"><b>Definition:</b> fitting.h:90</div></div>
<div class="ttc" id="classstp_1_1_gaussian_analytic_html"><div class="ttname"><a href="classstp_1_1_gaussian_analytic.html">stp::GaussianAnalytic</a></div><div class="ttdoc">Computes residual and jacobian on the given point x,y for gaussian fitting using analytic derivatives...</div><div class="ttdef"><b>Definition:</b> fitting.h:305</div></div>
<div class="ttc" id="structstp_1_1_bounding_box_html"><div class="ttname"><a href="structstp_1_1_bounding_box.html">stp::BoundingBox</a></div><div class="ttdoc">Represents bounding box positions: top, bottom, left and right margins. </div><div class="ttdef"><b>Definition:</b> fitting.h:18</div></div>
<div class="ttc" id="structstp_1_1_bounding_box_html_a42ffd05da73f34a9b92d67c988157b0b"><div class="ttname"><a href="structstp_1_1_bounding_box.html#a42ffd05da73f34a9b92d67c988157b0b">stp::BoundingBox::bottom</a></div><div class="ttdeci">int bottom</div><div class="ttdef"><b>Definition:</b> fitting.h:20</div></div>
<div class="ttc" id="structstp_1_1_gaussian2d_fit_html_a06c0a70f9f5fb23c6ea7cb55fba33527"><div class="ttname"><a href="structstp_1_1_gaussian2d_fit.html#a06c0a70f9f5fb23c6ea7cb55fba33527">stp::Gaussian2dFit::y_centre</a></div><div class="ttdeci">double y_centre</div><div class="ttdef"><b>Definition:</b> fitting.h:87</div></div>
<div class="ttc" id="structstp_1_1_bounding_box_html_aae17bfc0c907cc50aa9e1b19ece90ab0"><div class="ttname"><a href="structstp_1_1_bounding_box.html#aae17bfc0c907cc50aa9e1b19ece90ab0">stp::BoundingBox::BoundingBox</a></div><div class="ttdeci">BoundingBox(int in_top, int in_bottom, int in_left, int in_right)</div><div class="ttdoc">BoundingBox constructor that sets all parameters. </div><div class="ttdef"><b>Definition:</b> fitting.h:45</div></div>
<div class="ttc" id="structstp_1_1_bounding_box_html_a3e852371cfe56aa2e7d3d634369526a3"><div class="ttname"><a href="structstp_1_1_bounding_box.html#a3e852371cfe56aa2e7d3d634369526a3">stp::BoundingBox::BoundingBox</a></div><div class="ttdeci">BoundingBox()</div><div class="ttdoc">Default BoundingBox constructor. </div><div class="ttdef"><b>Definition:</b> fitting.h:29</div></div>
<div class="ttc" id="classstp_1_1_gaussian_residual_html_a69a862992ba9461ccda9ffaaade70916"><div class="ttname"><a href="classstp_1_1_gaussian_residual.html#a69a862992ba9461ccda9ffaaade70916">stp::GaussianResidual::operator()</a></div><div class="ttdeci">bool operator()(const T *const params, T *residual) const</div><div class="ttdoc">Operator that computes residuals of between data and 2D gaussian model. </div><div class="ttdef"><b>Definition:</b> fitting.h:167</div></div>
<div class="ttc" id="structstp_1_1_gaussian2d_fit_html_a56010c0b1910b15f716ec079f9e96721"><div class="ttname"><a href="structstp_1_1_gaussian2d_fit.html#a56010c0b1910b15f716ec079f9e96721">stp::Gaussian2dFit::semimajor</a></div><div class="ttdeci">double semimajor</div><div class="ttdef"><b>Definition:</b> fitting.h:88</div></div>
<div class="ttc" id="structstp_1_1_bounding_box_html_a5e1b106dcd0dcf1bae545155ab9650fc"><div class="ttname"><a href="structstp_1_1_bounding_box.html#a5e1b106dcd0dcf1bae545155ab9650fc">stp::BoundingBox::get_width</a></div><div class="ttdeci">int get_width()</div><div class="ttdoc">Bounding box width. </div><div class="ttdef"><b>Definition:</b> fitting.h:58</div></div>
<div class="ttc" id="structstp_1_1_gaussian2d_fit_html"><div class="ttname"><a href="structstp_1_1_gaussian2d_fit.html">stp::Gaussian2dFit</a></div><div class="ttdoc">The Gaussian2dFit struct. </div><div class="ttdef"><b>Definition:</b> fitting.h:84</div></div>
<div class="ttc" id="structstp_1_1_bounding_box_html_a1b25cedf5d232bbd501ecd93108157a5"><div class="ttname"><a href="structstp_1_1_bounding_box.html#a1b25cedf5d232bbd501ecd93108157a5">stp::BoundingBox::get_height</a></div><div class="ttdeci">int get_height()</div><div class="ttdoc">Bounding box height. </div><div class="ttdef"><b>Definition:</b> fitting.h:68</div></div>
<div class="ttc" id="structstp_1_1_gaussian2d_fit_html_a749842ca57caedb0050961d4edda463b"><div class="ttname"><a href="structstp_1_1_gaussian2d_fit.html#a749842ca57caedb0050961d4edda463b">stp::Gaussian2dFit::x_centre</a></div><div class="ttdeci">double x_centre</div><div class="ttdef"><b>Definition:</b> fitting.h:86</div></div>
<div class="ttc" id="classstp_1_1_gaussian_residual_html"><div class="ttname"><a href="classstp_1_1_gaussian_residual.html">stp::GaussianResidual</a></div><div class="ttdoc">Functor that computes the residual on the given point x,y between source data and 2D gaussian model...</div><div class="ttdef"><b>Definition:</b> fitting.h:144</div></div>
<div class="ttc" id="structstp_1_1_gaussian2d_fit_html_ab516face3c6a2aef1eaae187cc517b8c"><div class="ttname"><a href="structstp_1_1_gaussian2d_fit.html#ab516face3c6a2aef1eaae187cc517b8c">stp::Gaussian2dFit::semiminor</a></div><div class="ttdeci">double semiminor</div><div class="ttdef"><b>Definition:</b> fitting.h:89</div></div>
<div class="ttc" id="structstp_1_1_bounding_box_html_ac14eb4f1efe47409b913fab82387af0e"><div class="ttname"><a href="structstp_1_1_bounding_box.html#ac14eb4f1efe47409b913fab82387af0e">stp::BoundingBox::left</a></div><div class="ttdeci">int left</div><div class="ttdef"><b>Definition:</b> fitting.h:21</div></div>
<div class="ttc" id="structstp_1_1_bounding_box_html_a1ece3e9432bf6f727d960c03d95c620b"><div class="ttname"><a href="structstp_1_1_bounding_box.html#a1ece3e9432bf6f727d960c03d95c620b">stp::BoundingBox::right</a></div><div class="ttdeci">int right</div><div class="ttdef"><b>Definition:</b> fitting.h:22</div></div>
<div class="ttc" id="classstp_1_1_gaussian_all_residuals_html_acd0a39caab3be9fa027f4b4d4701ab82"><div class="ttname"><a href="classstp_1_1_gaussian_all_residuals.html#acd0a39caab3be9fa027f4b4d4701ab82">stp::GaussianAllResiduals::GaussianAllResiduals</a></div><div class="ttdeci">GaussianAllResiduals(const arma::Mat&lt; real_t &gt; &amp;data, const arma::Mat&lt; int &gt; &amp;label_map, const BoundingBox &amp;box, const int label_idx)</div><div class="ttdoc">GaussianAllResiduals constructor. </div><div class="ttdef"><b>Definition:</b> fitting.h:221</div></div>
<div class="ttc" id="structstp_1_1_gaussian2d_fit_html_a5c7767669adefb245374ec6c49a47e1c"><div class="ttname"><a href="structstp_1_1_gaussian2d_fit.html#a5c7767669adefb245374ec6c49a47e1c">stp::Gaussian2dFit::Gaussian2dFit</a></div><div class="ttdeci">Gaussian2dFit(double in_amplitude, double in_x_centre, double in_y_centre, double in_semimajor, double in_semiminor, double in_theta)</div><div class="ttdoc">Gaussian2dFit constructor that sets all parameters. </div><div class="ttdef"><b>Definition:</b> fitting.h:117</div></div>
<div class="ttc" id="structstp_1_1_bounding_box_html_a42675b807603afceddf023780b44ee15"><div class="ttname"><a href="structstp_1_1_bounding_box.html#a42675b807603afceddf023780b44ee15">stp::BoundingBox::top</a></div><div class="ttdeci">int top</div><div class="ttdef"><b>Definition:</b> fitting.h:19</div></div>
<div class="ttc" id="classstp_1_1_gaussian_all_residuals_html"><div class="ttname"><a href="classstp_1_1_gaussian_all_residuals.html">stp::GaussianAllResiduals</a></div><div class="ttdoc">Functor that computes all residuals between source data and 2D gaussian model. </div><div class="ttdef"><b>Definition:</b> fitting.h:211</div></div>
<div class="ttc" id="namespacestp_html"><div class="ttname"><a href="namespacestp.html">stp</a></div><div class="ttdef"><b>Definition:</b> ccl.cpp:17</div></div>
<div class="ttc" id="classstp_1_1_gaussian_analytic_html_a4837f810e4883cf759c67ffe26940bc5"><div class="ttname"><a href="classstp_1_1_gaussian_analytic.html#a4837f810e4883cf759c67ffe26940bc5">stp::GaussianAnalytic::GaussianAnalytic</a></div><div class="ttdeci">GaussianAnalytic(const double data, const double x, const double y)</div><div class="ttdoc">GaussianAnalytic constructor. </div><div class="ttdef"><b>Definition:</b> fitting.h:314</div></div>
<div class="ttc" id="classstp_1_1_gaussian_analytic_all_residuals_html_ab115cfb4f4d97ed3f879d296b0cef3b3"><div class="ttname"><a href="classstp_1_1_gaussian_analytic_all_residuals.html#ab115cfb4f4d97ed3f879d296b0cef3b3">stp::GaussianAnalyticAllResiduals::GaussianAnalyticAllResiduals</a></div><div class="ttdeci">GaussianAnalyticAllResiduals(const arma::Mat&lt; real_t &gt; &amp;data, const arma::Mat&lt; int &gt; &amp;label_map, const BoundingBox &amp;box, const int label_idx, const int num_residuals, const int parameter_block_size)</div><div class="ttdoc">GaussianAnalyticAllResiduals constructor. </div><div class="ttdef"><b>Definition:</b> fitting.h:352</div></div>
<div class="ttc" id="structstp_1_1_gaussian2d_fit_html_a70741214b36229ea1f4e5332442f10b1"><div class="ttname"><a href="structstp_1_1_gaussian2d_fit.html#a70741214b36229ea1f4e5332442f10b1">stp::Gaussian2dFit::amplitude</a></div><div class="ttdeci">double amplitude</div><div class="ttdef"><b>Definition:</b> fitting.h:85</div></div>
<div class="ttc" id="classstp_1_1_gaussian_analytic_all_residuals_html"><div class="ttname"><a href="classstp_1_1_gaussian_analytic_all_residuals.html">stp::GaussianAnalyticAllResiduals</a></div><div class="ttdoc">Computes all source residuals and jacobians for gaussian fitting using analytic derivatives. </div><div class="ttdef"><b>Definition:</b> fitting.h:340</div></div>
<div class="ttc" id="classstp_1_1_gaussian_all_residuals_html_a5bb27d068d373fd741f7c091b6a3a9c1"><div class="ttname"><a href="classstp_1_1_gaussian_all_residuals.html#a5bb27d068d373fd741f7c091b6a3a9c1">stp::GaussianAllResiduals::operator()</a></div><div class="ttdeci">bool operator()(const T *const params, T *residual) const</div><div class="ttdoc">Operator that computes residuals of between data and 2D gaussian model. </div><div class="ttdef"><b>Definition:</b> fitting.h:236</div></div>
<div class="ttc" id="classstp_1_1_gaussian_residual_html_a23d8c1a409da25e6cb3e3093469d6b3a"><div class="ttname"><a href="classstp_1_1_gaussian_residual.html#a23d8c1a409da25e6cb3e3093469d6b3a">stp::GaussianResidual::GaussianResidual</a></div><div class="ttdeci">GaussianResidual(const double data, const double x, const double y)</div><div class="ttdoc">GaussianResidual constructor. </div><div class="ttdef"><b>Definition:</b> fitting.h:153</div></div>
<div class="ttc" id="structstp_1_1_gaussian2d_fit_html_ad4a6ecef61116e3d841a99875f10dc3b"><div class="ttname"><a href="structstp_1_1_gaussian2d_fit.html#ad4a6ecef61116e3d841a99875f10dc3b">stp::Gaussian2dFit::Gaussian2dFit</a></div><div class="ttdeci">Gaussian2dFit()</div><div class="ttdoc">Default Gaussian2dFit constructor. </div><div class="ttdef"><b>Definition:</b> fitting.h:97</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
