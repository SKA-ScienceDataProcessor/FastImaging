<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Slow Transients Pipeline Prototype: /home/lucas/skadev/FastImaging/src/stp/sourcefind/sourcefind.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="science_data_processor_logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Slow Transients Pipeline Prototype
   </div>
   <div id="projectbrief">Component of the Science Data Processor being developed in the context of the Square Kilometre Array international project, which provides fast snapshot imaging, object detection and cataloguing for the identification of astrophysical image-plane transients.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_71906deff00c706128a95d3938125d0a.html">stp</a></li><li class="navelem"><a class="el" href="dir_389da9bd1b138630925c64dfd5b54283.html">sourcefind</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">sourcefind.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="sourcefind_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#ifndef SOURCE_FIND_H</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#define SOURCE_FIND_H</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;../common/ccl.h&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;../common/matrix_math.h&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;../common/matstp.h&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;../types.h&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="fitting_8h.html">fitting.h</a>&quot;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;cassert&gt;</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;cfloat&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;functional&gt;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;map&gt;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacestp.html">stp</a> {</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">extern</span> std::vector&lt;std::chrono::high_resolution_clock::time_point&gt; <a class="code" href="namespacestp.html#a54c6b61e9265ab85495b35c81b13d43d">times_sf</a>;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="unionstp_1_1_float_twiddler.html">   28</a></span>&#160;<span class="keyword">union </span><a class="code" href="unionstp_1_1_float_twiddler.html">FloatTwiddler</a> {</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="unionstp_1_1_float_twiddler.html#aa9326bedbbd5e9f32a064dac1a40257c">   30</a></span>&#160;    <a class="code" href="unionstp_1_1_float_twiddler.html#aa9326bedbbd5e9f32a064dac1a40257c">FloatTwiddler</a>(<a class="code" href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a> num = 0.0<a class="code" href="unionstp_1_1_float_twiddler.html#aac94f58c0fd61637eb835a52fb7b5582">f</a>)</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;        : <a class="code" href="unionstp_1_1_float_twiddler.html#aac94f58c0fd61637eb835a52fb7b5582">f</a>(num)</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    }</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;</div><div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="unionstp_1_1_float_twiddler.html#aac94f58c0fd61637eb835a52fb7b5582">   35</a></span>&#160;    <a class="code" href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a> <a class="code" href="unionstp_1_1_float_twiddler.html#aac94f58c0fd61637eb835a52fb7b5582">f</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#ifdef USE_FLOAT</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    int32_t <a class="code" href="unionstp_1_1_float_twiddler.html#af69e4244dc868957da13af58a53fcf9f">i</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="unionstp_1_1_float_twiddler.html#af69e4244dc868957da13af58a53fcf9f">   39</a></span>&#160;    int64_t <a class="code" href="unionstp_1_1_float_twiddler.html#af69e4244dc868957da13af58a53fcf9f">i</a>;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;};</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespacestp.html#a276a9a7f4bb8bc1db6451515349d3e8d">estimate_rms</a>(<span class="keyword">const</span> arma::Mat&lt;real_t&gt;&amp; data, <span class="keywordtype">double</span> num_sigma = 3, uint iters = 5, <a class="code" href="structstp_1_1_data_stats.html">DataStats</a> stats = <a class="code" href="structstp_1_1_data_stats.html">DataStats</a>(arma::datum::nan, arma::datum::nan, arma::datum::nan));</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structstp_1_1_island_params.html">   64</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structstp_1_1_island_params.html">IslandParams</a> {</div><div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structstp_1_1_island_params.html#a9a5f305028eb66abd711df5e267cf19b">   65</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstp_1_1_island_params.html#a9a5f305028eb66abd711df5e267cf19b">label_idx</a>;</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="structstp_1_1_island_params.html#ab36d033ef48f7b33b86b4fe6d9da7784">   66</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structstp_1_1_island_params.html#ab36d033ef48f7b33b86b4fe6d9da7784">extremum_val</a>;</div><div class="line"><a name="l00067"></a><span class="lineno"><a class="line" href="structstp_1_1_island_params.html#a796eca1520cebb3629b89cfad91494de">   67</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstp_1_1_island_params.html#a796eca1520cebb3629b89cfad91494de">extremum_y_idx</a>;</div><div class="line"><a name="l00068"></a><span class="lineno"><a class="line" href="structstp_1_1_island_params.html#a6061954939b09305c01be29dff6a21df">   68</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstp_1_1_island_params.html#a6061954939b09305c01be29dff6a21df">extremum_x_idx</a>;</div><div class="line"><a name="l00069"></a><span class="lineno"><a class="line" href="structstp_1_1_island_params.html#a41767366442b987aafb1cd33b4dfe330">   69</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structstp_1_1_island_params.html#a41767366442b987aafb1cd33b4dfe330">ybar</a>;</div><div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="structstp_1_1_island_params.html#a9bc8572b2950d081c47daa3ef963910d">   70</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="structstp_1_1_island_params.html#a9bc8572b2950d081c47daa3ef963910d">xbar</a>;</div><div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="structstp_1_1_island_params.html#adc57d892636ca70f215ddee5d0436aa8">   71</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structstp_1_1_island_params.html#adc57d892636ca70f215ddee5d0436aa8">sign</a>;</div><div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="structstp_1_1_island_params.html#a1d638080a9de05dadff715186daf488e">   72</a></span>&#160;    <a class="code" href="structstp_1_1_bounding_box.html">BoundingBox</a> <a class="code" href="structstp_1_1_island_params.html#a1d638080a9de05dadff715186daf488e">bounding_box</a>;</div><div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="structstp_1_1_island_params.html#a186ff1073490b97895fc3a4b0685eb08">   73</a></span>&#160;    <a class="code" href="structstp_1_1_gaussian2d_fit.html">Gaussian2dFit</a> <a class="code" href="structstp_1_1_island_params.html#a186ff1073490b97895fc3a4b0685eb08">fit</a>;</div><div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structstp_1_1_island_params.html#a20761c06ee518918ff90583e981ad0a4">   74</a></span>&#160;    std::string <a class="code" href="structstp_1_1_island_params.html#a20761c06ee518918ff90583e981ad0a4">ceres_report</a>;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <a class="code" href="structstp_1_1_island_params.html">IslandParams</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <a class="code" href="structstp_1_1_island_params.html">IslandParams</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> label, <span class="keyword">const</span> <a class="code" href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a> l_extremum, <span class="keyword">const</span> <span class="keywordtype">int</span> l_extremum_coord_y,</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> l_extremum_coord_x, <span class="keyword">const</span> <a class="code" href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a> barycentre_y, <span class="keyword">const</span> <a class="code" href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a> barycentre_x,</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keyword">const</span> <a class="code" href="structstp_1_1_bounding_box.html">BoundingBox</a>&amp; box = <a class="code" href="structstp_1_1_bounding_box.html">BoundingBox</a>());</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordtype">void</span> fit_gaussian_2d(<span class="keyword">const</span> arma::Mat&lt;real_t&gt;&amp; data, <span class="keyword">const</span> arma::Mat&lt;int&gt;&amp; label_map, <a class="code" href="namespacestp.html#a30ea75fc2a28e18b48e3a9939e3760a9">CeresDiffMethod</a> ceres_diffmethod, <a class="code" href="namespacestp.html#ae604b01190a3a3414720a85c806fd7d6">CeresSolverType</a> ceres_solvertype);</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordtype">bool</span> operator==(<span class="keyword">const</span> <a class="code" href="structstp_1_1_island_params.html">IslandParams</a>&amp; other) <span class="keyword">const</span>;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;};</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html">  131</a></span>&#160;<span class="keyword">class </span><a class="code" href="classstp_1_1_source_find_image.html">SourceFindImage</a> {</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00134"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#af9ca10dfc561544b683561fbb8852611">  134</a></span>&#160;    <a class="code" href="classstp_1_1_mat_stp.html">MatStp&lt;int&gt;</a> <a class="code" href="classstp_1_1_source_find_image.html#af9ca10dfc561544b683561fbb8852611">label_map</a>;</div><div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#ad09e92d9e4068a43903a8bd170c4ae19">  135</a></span>&#160;    arma::Col&lt;real_t&gt; <a class="code" href="classstp_1_1_source_find_image.html#ad09e92d9e4068a43903a8bd170c4ae19">label_extrema_val_pos</a>;</div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#a34a8772f9d3dc287c7e4910a7168f372">  136</a></span>&#160;    arma::Col&lt;real_t&gt; <a class="code" href="classstp_1_1_source_find_image.html#a34a8772f9d3dc287c7e4910a7168f372">label_extrema_val_neg</a>;</div><div class="line"><a name="l00137"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#af4063901421cfb5f753b479aab2ad7db">  137</a></span>&#160;    arma::uvec <a class="code" href="classstp_1_1_source_find_image.html#af4063901421cfb5f753b479aab2ad7db">label_extrema_linear_idx_pos</a>;</div><div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#a1d2c033d79392d1d97aa9f8cb868e5be">  138</a></span>&#160;    arma::uvec <a class="code" href="classstp_1_1_source_find_image.html#a1d2c033d79392d1d97aa9f8cb868e5be">label_extrema_linear_idx_neg</a>;</div><div class="line"><a name="l00139"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#a5f310d11c64d245279667759f87c77c5">  139</a></span>&#160;    arma::ivec <a class="code" href="classstp_1_1_source_find_image.html#a5f310d11c64d245279667759f87c77c5">label_extrema_id_pos</a>;</div><div class="line"><a name="l00140"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#af562c6560092d63c664cc5e9de2821e9">  140</a></span>&#160;    arma::ivec <a class="code" href="classstp_1_1_source_find_image.html#af562c6560092d63c664cc5e9de2821e9">label_extrema_id_neg</a>;</div><div class="line"><a name="l00141"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#a39cff59abe5c12f7cd9a94f9b696a260">  141</a></span>&#160;    arma::mat <a class="code" href="classstp_1_1_source_find_image.html#a39cff59abe5c12f7cd9a94f9b696a260">label_extrema_barycentre_pos</a>;</div><div class="line"><a name="l00142"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#a203cd728d478b51f93283f29df16775f">  142</a></span>&#160;    arma::mat <a class="code" href="classstp_1_1_source_find_image.html#a203cd728d478b51f93283f29df16775f">label_extrema_barycentre_neg</a>;</div><div class="line"><a name="l00143"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#ad32a230f6466de8a8e7332a6d277de1f">  143</a></span>&#160;    tbb::concurrent_vector&lt;BoundingBox&gt; <a class="code" href="classstp_1_1_source_find_image.html#ad32a230f6466de8a8e7332a6d277de1f">label_extrema_boundingbox_pos</a>;</div><div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#aa961cc77e4a68f50f30ca1c964e15c20">  144</a></span>&#160;    tbb::concurrent_vector&lt;BoundingBox&gt; <a class="code" href="classstp_1_1_source_find_image.html#aa961cc77e4a68f50f30ca1c964e15c20">label_extrema_boundingbox_neg</a>;</div><div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#a53321dbc35a15d84c71a47cc1e990504">  145</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classstp_1_1_source_find_image.html#a53321dbc35a15d84c71a47cc1e990504">detection_n_sigma</a>;</div><div class="line"><a name="l00146"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#aff1c7414afe9648987d311c7ef05bc0c">  146</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classstp_1_1_source_find_image.html#aff1c7414afe9648987d311c7ef05bc0c">analysis_n_sigma</a>;</div><div class="line"><a name="l00147"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#af83138449ac4188590875429e42e65b0">  147</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classstp_1_1_source_find_image.html#af83138449ac4188590875429e42e65b0">rms_est</a>;</div><div class="line"><a name="l00148"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#a397f803245e32fad66fcae3cb38ed1e8">  148</a></span>&#160;    <span class="keywordtype">double</span> <a class="code" href="classstp_1_1_source_find_image.html#a397f803245e32fad66fcae3cb38ed1e8">bg_level</a>;</div><div class="line"><a name="l00149"></a><span class="lineno"><a class="line" href="classstp_1_1_source_find_image.html#aebe879d6f1675cd6aa471a310ace8cd1">  149</a></span>&#160;    std::vector&lt;IslandParams&gt; <a class="code" href="classstp_1_1_source_find_image.html#aebe879d6f1675cd6aa471a310ace8cd1">islands</a>;</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">// There&#39;s no default constructor</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="classstp_1_1_source_find_image.html">SourceFindImage</a>() = <span class="keyword">delete</span>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <a class="code" href="classstp_1_1_source_find_image.html">SourceFindImage</a>(</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keyword">const</span> arma::Mat&lt;real_t&gt;&amp; input_data,</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordtype">double</span> input_detection_n_sigma,</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordtype">double</span> input_analysis_n_sigma,</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordtype">double</span> input_rms_est = 0.0,</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordtype">bool</span> find_negative_sources = <span class="keyword">true</span>,</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        uint sigma_clip_iters = 5,</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        <span class="keywordtype">bool</span> binapprox_median = <span class="keyword">false</span>,</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordtype">bool</span> compute_barycentre = <span class="keyword">true</span>,</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordtype">bool</span> gaussian_fitting = <span class="keyword">false</span>,</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordtype">bool</span> generate_labelmap = <span class="keyword">true</span>,</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <a class="code" href="namespacestp.html#a30ea75fc2a28e18b48e3a9939e3760a9">CeresDiffMethod</a> ceres_diffmethod = <a class="code" href="namespacestp.html#a30ea75fc2a28e18b48e3a9939e3760a9a4db6200d2a3fb2b994ff83a49c99a6d4">CeresDiffMethod::AutoDiff_SingleResBlk</a>,</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <a class="code" href="namespacestp.html#ae604b01190a3a3414720a85c806fd7d6">CeresSolverType</a> ceres_solvertype = <a class="code" href="namespacestp.html#ae604b01190a3a3414720a85c806fd7d6afd0d5b1f6ee7757ec90dce1107dcef00">CeresSolverType::LinearSearch_BFGS</a>);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> generateLabelMap&gt;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    uint _label_detection_islands(<span class="keyword">const</span> arma::Mat&lt;real_t&gt;&amp; data, <span class="keywordtype">bool</span> find_negative_sources = <span class="keyword">true</span>, <span class="keywordtype">bool</span> compute_barycentre = <span class="keyword">true</span>, <span class="keywordtype">bool</span> gaussian_fitting = <span class="keyword">false</span>);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;};</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;}</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* SOURCE_FIND_H */</span><span class="preprocessor"></span></div><div class="ttc" id="classstp_1_1_source_find_image_html_af83138449ac4188590875429e42e65b0"><div class="ttname"><a href="classstp_1_1_source_find_image.html#af83138449ac4188590875429e42e65b0">stp::SourceFindImage::rms_est</a></div><div class="ttdeci">double rms_est</div><div class="ttdef"><b>Definition:</b> sourcefind.h:147</div></div>
<div class="ttc" id="structstp_1_1_island_params_html_a9a5f305028eb66abd711df5e267cf19b"><div class="ttname"><a href="structstp_1_1_island_params.html#a9a5f305028eb66abd711df5e267cf19b">stp::IslandParams::label_idx</a></div><div class="ttdeci">int label_idx</div><div class="ttdef"><b>Definition:</b> sourcefind.h:65</div></div>
<div class="ttc" id="namespacestp_html_ae604b01190a3a3414720a85c806fd7d6afd0d5b1f6ee7757ec90dce1107dcef00"><div class="ttname"><a href="namespacestp.html#ae604b01190a3a3414720a85c806fd7d6afd0d5b1f6ee7757ec90dce1107dcef00">stp::CeresSolverType::LinearSearch_BFGS</a></div></div>
<div class="ttc" id="structstp_1_1_bounding_box_html"><div class="ttname"><a href="structstp_1_1_bounding_box.html">stp::BoundingBox</a></div><div class="ttdoc">Represents bounding box positions: top, bottom, left and right margins. </div><div class="ttdef"><b>Definition:</b> fitting.h:18</div></div>
<div class="ttc" id="structstp_1_1_island_params_html_a6061954939b09305c01be29dff6a21df"><div class="ttname"><a href="structstp_1_1_island_params.html#a6061954939b09305c01be29dff6a21df">stp::IslandParams::extremum_x_idx</a></div><div class="ttdeci">int extremum_x_idx</div><div class="ttdef"><b>Definition:</b> sourcefind.h:68</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_a39cff59abe5c12f7cd9a94f9b696a260"><div class="ttname"><a href="classstp_1_1_source_find_image.html#a39cff59abe5c12f7cd9a94f9b696a260">stp::SourceFindImage::label_extrema_barycentre_pos</a></div><div class="ttdeci">arma::mat label_extrema_barycentre_pos</div><div class="ttdef"><b>Definition:</b> sourcefind.h:141</div></div>
<div class="ttc" id="structstp_1_1_island_params_html_a796eca1520cebb3629b89cfad91494de"><div class="ttname"><a href="structstp_1_1_island_params.html#a796eca1520cebb3629b89cfad91494de">stp::IslandParams::extremum_y_idx</a></div><div class="ttdeci">int extremum_y_idx</div><div class="ttdef"><b>Definition:</b> sourcefind.h:67</div></div>
<div class="ttc" id="namespacestp_html_ae604b01190a3a3414720a85c806fd7d6"><div class="ttname"><a href="namespacestp.html#ae604b01190a3a3414720a85c806fd7d6">stp::CeresSolverType</a></div><div class="ttdeci">CeresSolverType</div><div class="ttdoc">Enum of available solver types used by ceres library for gaussian fitting. </div><div class="ttdef"><b>Definition:</b> types.h:63</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_af9ca10dfc561544b683561fbb8852611"><div class="ttname"><a href="classstp_1_1_source_find_image.html#af9ca10dfc561544b683561fbb8852611">stp::SourceFindImage::label_map</a></div><div class="ttdeci">MatStp&lt; int &gt; label_map</div><div class="ttdef"><b>Definition:</b> sourcefind.h:134</div></div>
<div class="ttc" id="structstp_1_1_island_params_html_a41767366442b987aafb1cd33b4dfe330"><div class="ttname"><a href="structstp_1_1_island_params.html#a41767366442b987aafb1cd33b4dfe330">stp::IslandParams::ybar</a></div><div class="ttdeci">double ybar</div><div class="ttdef"><b>Definition:</b> sourcefind.h:69</div></div>
<div class="ttc" id="structstp_1_1_island_params_html_ab36d033ef48f7b33b86b4fe6d9da7784"><div class="ttname"><a href="structstp_1_1_island_params.html#ab36d033ef48f7b33b86b4fe6d9da7784">stp::IslandParams::extremum_val</a></div><div class="ttdeci">double extremum_val</div><div class="ttdef"><b>Definition:</b> sourcefind.h:66</div></div>
<div class="ttc" id="namespacestp_html_a276a9a7f4bb8bc1db6451515349d3e8d"><div class="ttname"><a href="namespacestp.html#a276a9a7f4bb8bc1db6451515349d3e8d">stp::estimate_rms</a></div><div class="ttdeci">double estimate_rms(const arma::Mat&lt; real_t &gt; &amp;data, double num_sigma, uint iters, DataStats stats)</div><div class="ttdoc">Perform sigma-clip and estimate RMS of input matrix. </div><div class="ttdef"><b>Definition:</b> sourcefind.cpp:25</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_a1d2c033d79392d1d97aa9f8cb868e5be"><div class="ttname"><a href="classstp_1_1_source_find_image.html#a1d2c033d79392d1d97aa9f8cb868e5be">stp::SourceFindImage::label_extrema_linear_idx_neg</a></div><div class="ttdeci">arma::uvec label_extrema_linear_idx_neg</div><div class="ttdef"><b>Definition:</b> sourcefind.h:138</div></div>
<div class="ttc" id="structstp_1_1_gaussian2d_fit_html"><div class="ttname"><a href="structstp_1_1_gaussian2d_fit.html">stp::Gaussian2dFit</a></div><div class="ttdoc">The Gaussian2dFit struct. </div><div class="ttdef"><b>Definition:</b> fitting.h:84</div></div>
<div class="ttc" id="unionstp_1_1_float_twiddler_html_aa9326bedbbd5e9f32a064dac1a40257c"><div class="ttname"><a href="unionstp_1_1_float_twiddler.html#aa9326bedbbd5e9f32a064dac1a40257c">stp::FloatTwiddler::FloatTwiddler</a></div><div class="ttdeci">FloatTwiddler(real_t num=0.0f)</div><div class="ttdef"><b>Definition:</b> sourcefind.h:30</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_af4063901421cfb5f753b479aab2ad7db"><div class="ttname"><a href="classstp_1_1_source_find_image.html#af4063901421cfb5f753b479aab2ad7db">stp::SourceFindImage::label_extrema_linear_idx_pos</a></div><div class="ttdeci">arma::uvec label_extrema_linear_idx_pos</div><div class="ttdef"><b>Definition:</b> sourcefind.h:137</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_a397f803245e32fad66fcae3cb38ed1e8"><div class="ttname"><a href="classstp_1_1_source_find_image.html#a397f803245e32fad66fcae3cb38ed1e8">stp::SourceFindImage::bg_level</a></div><div class="ttdeci">double bg_level</div><div class="ttdef"><b>Definition:</b> sourcefind.h:148</div></div>
<div class="ttc" id="unionstp_1_1_float_twiddler_html_af69e4244dc868957da13af58a53fcf9f"><div class="ttname"><a href="unionstp_1_1_float_twiddler.html#af69e4244dc868957da13af58a53fcf9f">stp::FloatTwiddler::i</a></div><div class="ttdeci">int64_t i</div><div class="ttdef"><b>Definition:</b> sourcefind.h:39</div></div>
<div class="ttc" id="structstp_1_1_island_params_html_adc57d892636ca70f215ddee5d0436aa8"><div class="ttname"><a href="structstp_1_1_island_params.html#adc57d892636ca70f215ddee5d0436aa8">stp::IslandParams::sign</a></div><div class="ttdeci">int sign</div><div class="ttdef"><b>Definition:</b> sourcefind.h:71</div></div>
<div class="ttc" id="unionstp_1_1_float_twiddler_html"><div class="ttname"><a href="unionstp_1_1_float_twiddler.html">stp::FloatTwiddler</a></div><div class="ttdoc">Represents a floation-point number that can be accessed using the integer type. This union allows to ...</div><div class="ttdef"><b>Definition:</b> sourcefind.h:28</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_a203cd728d478b51f93283f29df16775f"><div class="ttname"><a href="classstp_1_1_source_find_image.html#a203cd728d478b51f93283f29df16775f">stp::SourceFindImage::label_extrema_barycentre_neg</a></div><div class="ttdeci">arma::mat label_extrema_barycentre_neg</div><div class="ttdef"><b>Definition:</b> sourcefind.h:142</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_aff1c7414afe9648987d311c7ef05bc0c"><div class="ttname"><a href="classstp_1_1_source_find_image.html#aff1c7414afe9648987d311c7ef05bc0c">stp::SourceFindImage::analysis_n_sigma</a></div><div class="ttdeci">double analysis_n_sigma</div><div class="ttdef"><b>Definition:</b> sourcefind.h:146</div></div>
<div class="ttc" id="namespacestp_html_a30ea75fc2a28e18b48e3a9939e3760a9"><div class="ttname"><a href="namespacestp.html#a30ea75fc2a28e18b48e3a9939e3760a9">stp::CeresDiffMethod</a></div><div class="ttdeci">CeresDiffMethod</div><div class="ttdoc">Enum of available differentiation methods used by ceres library for gaussian fitting. </div><div class="ttdef"><b>Definition:</b> types.h:53</div></div>
<div class="ttc" id="structstp_1_1_island_params_html_a20761c06ee518918ff90583e981ad0a4"><div class="ttname"><a href="structstp_1_1_island_params.html#a20761c06ee518918ff90583e981ad0a4">stp::IslandParams::ceres_report</a></div><div class="ttdeci">std::string ceres_report</div><div class="ttdef"><b>Definition:</b> sourcefind.h:74</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_af562c6560092d63c664cc5e9de2821e9"><div class="ttname"><a href="classstp_1_1_source_find_image.html#af562c6560092d63c664cc5e9de2821e9">stp::SourceFindImage::label_extrema_id_neg</a></div><div class="ttdeci">arma::ivec label_extrema_id_neg</div><div class="ttdef"><b>Definition:</b> sourcefind.h:140</div></div>
<div class="ttc" id="unionstp_1_1_float_twiddler_html_aac94f58c0fd61637eb835a52fb7b5582"><div class="ttname"><a href="unionstp_1_1_float_twiddler.html#aac94f58c0fd61637eb835a52fb7b5582">stp::FloatTwiddler::f</a></div><div class="ttdeci">real_t f</div><div class="ttdef"><b>Definition:</b> sourcefind.h:35</div></div>
<div class="ttc" id="classstp_1_1_mat_stp_html"><div class="ttname"><a href="classstp_1_1_mat_stp.html">stp::MatStp&lt; int &gt;</a></div></div>
<div class="ttc" id="fitting_8h_html"><div class="ttname"><a href="fitting_8h.html">fitting.h</a></div><div class="ttdoc">Classes and function prototypes of gaussian fitting. </div></div>
<div class="ttc" id="structstp_1_1_data_stats_html"><div class="ttname"><a href="structstp_1_1_data_stats.html">stp::DataStats</a></div><div class="ttdoc">Struct that stores computed statistics: mean, sigma, median. </div><div class="ttdef"><b>Definition:</b> matrix_math.h:22</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_ad32a230f6466de8a8e7332a6d277de1f"><div class="ttname"><a href="classstp_1_1_source_find_image.html#ad32a230f6466de8a8e7332a6d277de1f">stp::SourceFindImage::label_extrema_boundingbox_pos</a></div><div class="ttdeci">tbb::concurrent_vector&lt; BoundingBox &gt; label_extrema_boundingbox_pos</div><div class="ttdef"><b>Definition:</b> sourcefind.h:143</div></div>
<div class="ttc" id="structstp_1_1_island_params_html_a9bc8572b2950d081c47daa3ef963910d"><div class="ttname"><a href="structstp_1_1_island_params.html#a9bc8572b2950d081c47daa3ef963910d">stp::IslandParams::xbar</a></div><div class="ttdeci">double xbar</div><div class="ttdef"><b>Definition:</b> sourcefind.h:70</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_a5f310d11c64d245279667759f87c77c5"><div class="ttname"><a href="classstp_1_1_source_find_image.html#a5f310d11c64d245279667759f87c77c5">stp::SourceFindImage::label_extrema_id_pos</a></div><div class="ttdeci">arma::ivec label_extrema_id_pos</div><div class="ttdef"><b>Definition:</b> sourcefind.h:139</div></div>
<div class="ttc" id="namespacestp_html"><div class="ttname"><a href="namespacestp.html">stp</a></div><div class="ttdef"><b>Definition:</b> ccl.cpp:17</div></div>
<div class="ttc" id="namespacestp_html_a54c6b61e9265ab85495b35c81b13d43d"><div class="ttname"><a href="namespacestp.html#a54c6b61e9265ab85495b35c81b13d43d">stp::times_sf</a></div><div class="ttdeci">std::vector&lt; std::chrono::high_resolution_clock::time_point &gt; times_sf</div></div>
<div class="ttc" id="structstp_1_1_island_params_html_a1d638080a9de05dadff715186daf488e"><div class="ttname"><a href="structstp_1_1_island_params.html#a1d638080a9de05dadff715186daf488e">stp::IslandParams::bounding_box</a></div><div class="ttdeci">BoundingBox bounding_box</div><div class="ttdef"><b>Definition:</b> sourcefind.h:72</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_aebe879d6f1675cd6aa471a310ace8cd1"><div class="ttname"><a href="classstp_1_1_source_find_image.html#aebe879d6f1675cd6aa471a310ace8cd1">stp::SourceFindImage::islands</a></div><div class="ttdeci">std::vector&lt; IslandParams &gt; islands</div><div class="ttdef"><b>Definition:</b> sourcefind.h:149</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_a34a8772f9d3dc287c7e4910a7168f372"><div class="ttname"><a href="classstp_1_1_source_find_image.html#a34a8772f9d3dc287c7e4910a7168f372">stp::SourceFindImage::label_extrema_val_neg</a></div><div class="ttdeci">arma::Col&lt; real_t &gt; label_extrema_val_neg</div><div class="ttdef"><b>Definition:</b> sourcefind.h:136</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html"><div class="ttname"><a href="classstp_1_1_source_find_image.html">stp::SourceFindImage</a></div><div class="ttdoc">The SourceFindImage class for source detection. </div><div class="ttdef"><b>Definition:</b> sourcefind.h:131</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_ad09e92d9e4068a43903a8bd170c4ae19"><div class="ttname"><a href="classstp_1_1_source_find_image.html#ad09e92d9e4068a43903a8bd170c4ae19">stp::SourceFindImage::label_extrema_val_pos</a></div><div class="ttdeci">arma::Col&lt; real_t &gt; label_extrema_val_pos</div><div class="ttdef"><b>Definition:</b> sourcefind.h:135</div></div>
<div class="ttc" id="structstp_1_1_island_params_html_a186ff1073490b97895fc3a4b0685eb08"><div class="ttname"><a href="structstp_1_1_island_params.html#a186ff1073490b97895fc3a4b0685eb08">stp::IslandParams::fit</a></div><div class="ttdeci">Gaussian2dFit fit</div><div class="ttdef"><b>Definition:</b> sourcefind.h:73</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_a53321dbc35a15d84c71a47cc1e990504"><div class="ttname"><a href="classstp_1_1_source_find_image.html#a53321dbc35a15d84c71a47cc1e990504">stp::SourceFindImage::detection_n_sigma</a></div><div class="ttdeci">double detection_n_sigma</div><div class="ttdef"><b>Definition:</b> sourcefind.h:145</div></div>
<div class="ttc" id="classstp_1_1_source_find_image_html_aa961cc77e4a68f50f30ca1c964e15c20"><div class="ttname"><a href="classstp_1_1_source_find_image.html#aa961cc77e4a68f50f30ca1c964e15c20">stp::SourceFindImage::label_extrema_boundingbox_neg</a></div><div class="ttdeci">tbb::concurrent_vector&lt; BoundingBox &gt; label_extrema_boundingbox_neg</div><div class="ttdef"><b>Definition:</b> sourcefind.h:144</div></div>
<div class="ttc" id="types_8h_html_ab46614359717672dc9a4eed4669be6e6"><div class="ttname"><a href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a></div><div class="ttdeci">double real_t</div><div class="ttdef"><b>Definition:</b> types.h:16</div></div>
<div class="ttc" id="structstp_1_1_island_params_html"><div class="ttname"><a href="structstp_1_1_island_params.html">stp::IslandParams</a></div><div class="ttdoc">IslandParams struct. </div><div class="ttdef"><b>Definition:</b> sourcefind.h:64</div></div>
<div class="ttc" id="namespacestp_html_a30ea75fc2a28e18b48e3a9939e3760a9a4db6200d2a3fb2b994ff83a49c99a6d4"><div class="ttname"><a href="namespacestp.html#a30ea75fc2a28e18b48e3a9939e3760a9a4db6200d2a3fb2b994ff83a49c99a6d4">stp::CeresDiffMethod::AutoDiff_SingleResBlk</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
