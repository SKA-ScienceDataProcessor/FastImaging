<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Slow Transients Pipeline Prototype: /home/lucas/skadev/FastImaging/src/stp/gridder/aw_projection.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="science_data_processor_logo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Slow Transients Pipeline Prototype
   </div>
   <div id="projectbrief">Component of the Science Data Processor being developed in the context of the Square Kilometre Array international project, which provides fast snapshot imaging, object detection and cataloguing for the identification of astrophysical image-plane transients.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_71906deff00c706128a95d3938125d0a.html">stp</a></li><li class="navelem"><a class="el" href="dir_84de9b9706c9fd6890d1de19f7b2d5de.html">gridder</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">aw_projection.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="aw__projection_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#ifndef AW_PROJECTION_H</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#define AW_PROJECTION_H</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;../common/fft.h&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;../common/matstp.h&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;../common/spline.h&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;../types.h&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;armadillo&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacestp.html">stp</a> {</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="classstp_1_1_wide_field_imaging.html">   21</a></span>&#160;<span class="keyword">class </span><a class="code" href="classstp_1_1_wide_field_imaging.html">WideFieldImaging</a> {</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">public</span>:</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="classstp_1_1_wide_field_imaging.html#a2b66dc0148b8e66f4fa03d7726fb75aa">WideFieldImaging</a>() = <span class="keywordflow">default</span>;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classstp_1_1_wide_field_imaging.html#a2b66dc0148b8e66f4fa03d7726fb75aa">WideFieldImaging</a>(<span class="keywordtype">size_t</span> kernel_size, <span class="keywordtype">double</span> cell_size, <span class="keywordtype">int</span> oversampling, <span class="keywordtype">int</span> undersampling, <span class="keyword">const</span> <a class="code" href="structstp_1_1_w___projection_pars.html">W_ProjectionPars</a>&amp; w_proj,</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        <a class="code" href="namespacestp.html#a464d541245c3d8f9ea82f5d2d5484c98">FFTRoutine</a> r_fft = <a class="code" href="namespacestp.html#a464d541245c3d8f9ea82f5d2d5484c98a1551a8f00e3ff5f46b18636fb963ad8c">FFTRoutine::FFTW_ESTIMATE_FFT</a>);</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classstp_1_1_wide_field_imaging.html#a37802e179aff6ceae21e35312189b0a6">generate_combined_w_aa_kernel</a>(<span class="keywordtype">double</span> input_w_value, <span class="keyword">const</span> arma::Col&lt;real_t&gt;&amp; aa_kernel_img);</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classstp_1_1_wide_field_imaging.html#a99e16ca0726a77ff2a43692b79372ab0">generate_convolution_kernel_aproj</a>(<span class="keyword">const</span> arma::Mat&lt;real_t&gt;&amp; a_kernel_img);</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordtype">void</span> <a class="code" href="classstp_1_1_wide_field_imaging.html#a9a8453c69c2a794052f6cb991d959e66">generate_convolution_kernel_wproj</a>(<span class="keywordtype">double</span> input_w_value, <span class="keyword">const</span> arma::Col&lt;real_t&gt;&amp; aa_kernel_img);</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    arma::field&lt;arma::Mat&lt;cx_real_t&gt;&gt; <a class="code" href="classstp_1_1_wide_field_imaging.html#a2f5c2375da482d085a930876bca81d83">generate_kernel_cache</a>();</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="classstp_1_1_wide_field_imaging.html#ae9b3feaed0c11ecc7f5ae2bf08f7b248">   76</a></span>&#160;    <span class="keywordtype">int</span> <a class="code" href="classstp_1_1_wide_field_imaging.html#ae9b3feaed0c11ecc7f5ae2bf08f7b248">get_trunc_conv_support</a>()</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    {</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">return</span> truncated_wpconv_support;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="keyword">private</span>:</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <a class="code" href="classstp_1_1_mat_stp.html">MatStp&lt;cx_real_t&gt;</a> combine_kernels(<span class="keyword">const</span> arma::Col&lt;real_t&gt;&amp; aa_kernel_img, <span class="keyword">const</span> <span class="keywordtype">double</span> scaled_cell_size);</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keyword">inline</span> <a class="code" href="types_8h.html#a1d2a57e59f061705d305d324a80d4ca1">cx_real_t</a> combine_2d_kernel_value(<span class="keyword">const</span> arma::Col&lt;real_t&gt;&amp; aa_kernel_img,</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> pixel_x, <span class="keyword">const</span> <span class="keywordtype">int</span> pixel_y, <span class="keyword">const</span> <a class="code" href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a> fft_factor,</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> w_value, <span class="keyword">const</span> <span class="keywordtype">double</span> scaled_cell_size, <span class="keyword">const</span> <span class="keywordtype">int</span> ctr_idx);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    arma::Col&lt;real_t&gt; generate_hankel_radius_points(<span class="keywordtype">size_t</span> arrsize);</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    arma::Mat&lt;real_t&gt; dht(<span class="keywordtype">size_t</span> arrsize); <span class="comment">// Generate DHT Matrix</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> isCubic&gt;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    arma::Col&lt;cx_real_t&gt; RadialInterpolate(<span class="keyword">const</span> arma::Col&lt;real_t&gt;&amp; x_array, <span class="keyword">const</span> arma::Col&lt;cx_real_t&gt;&amp; y_array, <span class="keywordtype">double</span> trunc_at)</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    {</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        assert(x_array.n_elem &lt;= y_array.n_elem);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="classtk_1_1spline.html">tk::spline&lt;isCubic&gt;</a> m_spline_real;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="classtk_1_1spline.html">tk::spline&lt;isCubic&gt;</a> m_spline_imag;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">if</span> (trunc_at &gt; 0.0) {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            <span class="comment">//truncate kernel at a certain percentage from maximum</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <a class="code" href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a> min_value = std::abs(y_array[0]) * trunc_at;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;            <span class="keywordtype">int</span> trunc_idx = wp.<a class="code" href="structstp_1_1_w___projection_pars.html#a5881b977e8f6d4c1c375b1db45959a87">max_wpconv_support</a> * oversampling;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            <span class="keywordflow">while</span> (trunc_idx &gt; oversampling) {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                <span class="keywordflow">if</span> (std::abs(y_array[trunc_idx]) &gt; min_value) {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                }</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                trunc_idx -= oversampling;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            truncated_wpconv_support = std::min(<span class="keywordtype">int</span>((ceil(<span class="keywordtype">double</span>(trunc_idx) * M_SQRT2 / <span class="keywordtype">double</span>(oversampling)))), wp.<a class="code" href="structstp_1_1_w___projection_pars.html#a5881b977e8f6d4c1c375b1db45959a87">max_wpconv_support</a>);</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        }</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        current_hankel_kernel_size = (truncated_wpconv_support * 2 + 1 + 1) * oversampling;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">size_t</span> kernel_offset = current_hankel_kernel_size / 2;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">size_t</span> final_kernel_size = kernel_offset + (kernel_offset * (kernel_offset - 1) / 2);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        arma::Col&lt;cx_real_t&gt; tmp_kernel_half_quandrant(final_kernel_size);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="comment">// Extract real and imaginary parts</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordtype">size_t</span> n_elems = y_array.n_elem;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        arma::Col&lt;real_t&gt; y_array_real(n_elems);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        arma::Col&lt;real_t&gt; y_array_imag(n_elems);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n_elems; i++) {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            y_array_real(i) = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><a class="code" href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a>(&amp;)[2]<span class="keyword">&gt;</span>(y_array(i))[0];</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            y_array_imag(i) = <span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span><a class="code" href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a>(&amp;)[2]<span class="keyword">&gt;</span>(y_array(i))[1];</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        m_spline_real.<a class="code" href="classtk_1_1spline.html#aa775760d2db2bd9c281f23cfdc264896">set_points</a>(x_array, y_array_real, <span class="keyword">false</span>);</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        m_spline_imag.<a class="code" href="classtk_1_1spline.html#aa775760d2db2bd9c281f23cfdc264896">set_points</a>(x_array, y_array_imag, <span class="keyword">false</span>);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <a class="code" href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a> new_x;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordtype">size_t</span> k;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordtype">size_t</span> ii = 0, j = 0;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; final_kernel_size; i++, j++) {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;            <span class="keywordflow">if</span> (j == kernel_offset) {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                j = ++ii;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            }</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;            <span class="keywordflow">if</span> (j == 0)</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                new_x = ii;</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ii == 0)</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                new_x = j;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                new_x = std::sqrt(static_cast&lt;real_t&gt;(ii * ii + j * j));</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="comment">// find where the interpolation is going to happen</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            k = size_t(new_x * M_SQRT2);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;            <span class="comment">// numeric imprecision due to the M_SQRT1_2 division don&#39;t allow this next step to be skipped</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;            <span class="comment">// the speed gain will still be enourmous in comparison with the previous algorithm (that searched the whole array)</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            <span class="keywordflow">if</span> (new_x &lt; x_array(k)) {</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                <span class="keywordflow">if</span> (k &gt; 0)</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                    k--;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            }</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            <span class="comment">/* kernel_half_quandrant is an array that stores all the interpolated values of half a quadrant of the final kernel</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment">             * in the following index order:</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment">             *     .......</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment">             *     .......</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">             *     .......</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment">             *     ...0123</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment">             *     ....456</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">             *     .....78</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">             *     ......9</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            <a class="code" href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a> val_re = m_spline_real(new_x, k, x_array[k], y_array_real[k]);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <a class="code" href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a> val_im = m_spline_imag(new_x, k, x_array[k], y_array_imag[k]);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            assert(arma::is_finite(val_re));</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            assert(arma::is_finite(val_im));</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            tmp_kernel_half_quandrant[i] = <a class="code" href="types_8h.html#a1d2a57e59f061705d305d324a80d4ca1">cx_real_t</a>(val_re, val_im);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordflow">return</span> std::move(tmp_kernel_half_quandrant);</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    }</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">int</span> max_hankel_kernel_size;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordtype">int</span> current_hankel_kernel_size;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="keywordtype">int</span> truncated_wpconv_support;</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">double</span> w_value;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordtype">size_t</span> array_size;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="keywordtype">size_t</span> kernel_size;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="keywordtype">double</span> cell_size;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordtype">int</span> oversampling;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="keywordtype">int</span> undersampling;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    W_ProjectionPars wp;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="namespacestp.html#a464d541245c3d8f9ea82f5d2d5484c98">FFTRoutine</a> r_fft;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    MatStp&lt;cx_real_t&gt; comb_kernel;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    arma::Col&lt;cx_real_t&gt; kernel_half_quandrant;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    arma::Mat&lt;cx_real_t&gt; conv_kernel;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    arma::Mat&lt;real_t&gt; DHT;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    arma::Col&lt;real_t&gt; hankel_radius_points;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;};</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="keywordtype">double</span> <a class="code" href="namespacestp.html#a723e08fc37f8606211f7abbda740d4e1">parangle</a>(<span class="keywordtype">double</span> ha, <span class="keywordtype">double</span> dec_d, <span class="keywordtype">double</span> lat_d);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;}</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="preprocessor">#endif </span><span class="comment">/* AW_PROJECTION_H */</span><span class="preprocessor"></span></div><div class="ttc" id="namespacestp_html_a464d541245c3d8f9ea82f5d2d5484c98"><div class="ttname"><a href="namespacestp.html#a464d541245c3d8f9ea82f5d2d5484c98">stp::FFTRoutine</a></div><div class="ttdeci">FFTRoutine</div><div class="ttdoc">Enum of available FFT algorithms. </div><div class="ttdef"><b>Definition:</b> types.h:44</div></div>
<div class="ttc" id="namespacestp_html_a723e08fc37f8606211f7abbda740d4e1"><div class="ttname"><a href="namespacestp.html#a723e08fc37f8606211f7abbda740d4e1">stp::parangle</a></div><div class="ttdeci">double parangle(double ha, double dec_d, double lat_d)</div><div class="ttdoc">Compute parallatic angle for beam rotation. </div><div class="ttdef"><b>Definition:</b> aw_projection.cpp:485</div></div>
<div class="ttc" id="types_8h_html_a1d2a57e59f061705d305d324a80d4ca1"><div class="ttname"><a href="types_8h.html#a1d2a57e59f061705d305d324a80d4ca1">cx_real_t</a></div><div class="ttdeci">std::complex&lt; double &gt; cx_real_t</div><div class="ttdef"><b>Definition:</b> types.h:18</div></div>
<div class="ttc" id="namespacestp_html_a464d541245c3d8f9ea82f5d2d5484c98a1551a8f00e3ff5f46b18636fb963ad8c"><div class="ttname"><a href="namespacestp.html#a464d541245c3d8f9ea82f5d2d5484c98a1551a8f00e3ff5f46b18636fb963ad8c">stp::FFTRoutine::FFTW_ESTIMATE_FFT</a></div></div>
<div class="ttc" id="classtk_1_1spline_html"><div class="ttname"><a href="classtk_1_1spline.html">tk::spline</a></div><div class="ttdoc">The spline class. </div><div class="ttdef"><b>Definition:</b> spline.h:72</div></div>
<div class="ttc" id="classstp_1_1_mat_stp_html"><div class="ttname"><a href="classstp_1_1_mat_stp.html">stp::MatStp&lt; cx_real_t &gt;</a></div></div>
<div class="ttc" id="classtk_1_1spline_html_aa775760d2db2bd9c281f23cfdc264896"><div class="ttname"><a href="classtk_1_1spline.html#aa775760d2db2bd9c281f23cfdc264896">tk::spline::set_points</a></div><div class="ttdeci">void set_points(const arma::Col&lt; real_t &gt; &amp;x, const arma::Col&lt; real_t &gt; &amp;y, bool copy=true)</div><div class="ttdoc">Set points for interpolation If copy parameter is false, data is not stored internally. This provides computational savings since memcopy operations are not performed. </div><div class="ttdef"><b>Definition:</b> spline.h:129</div></div>
<div class="ttc" id="classstp_1_1_wide_field_imaging_html_a2f5c2375da482d085a930876bca81d83"><div class="ttname"><a href="classstp_1_1_wide_field_imaging.html#a2f5c2375da482d085a930876bca81d83">stp::WideFieldImaging::generate_kernel_cache</a></div><div class="ttdeci">arma::field&lt; arma::Mat&lt; cx_real_t &gt; &gt; generate_kernel_cache()</div><div class="ttdoc">Generate a cache of kernels at oversampled-pixel offsets for A/W-Projection. </div><div class="ttdef"><b>Definition:</b> aw_projection.cpp:215</div></div>
<div class="ttc" id="structstp_1_1_w___projection_pars_html_a5881b977e8f6d4c1c375b1db45959a87"><div class="ttname"><a href="structstp_1_1_w___projection_pars.html#a5881b977e8f6d4c1c375b1db45959a87">stp::W_ProjectionPars::max_wpconv_support</a></div><div class="ttdeci">int max_wpconv_support</div><div class="ttdef"><b>Definition:</b> types.h:232</div></div>
<div class="ttc" id="structstp_1_1_w___projection_pars_html"><div class="ttname"><a href="structstp_1_1_w___projection_pars.html">stp::W_ProjectionPars</a></div><div class="ttdoc">W-projection settings. </div><div class="ttdef"><b>Definition:</b> types.h:171</div></div>
<div class="ttc" id="classstp_1_1_wide_field_imaging_html_a9a8453c69c2a794052f6cb991d959e66"><div class="ttname"><a href="classstp_1_1_wide_field_imaging.html#a9a8453c69c2a794052f6cb991d959e66">stp::WideFieldImaging::generate_convolution_kernel_wproj</a></div><div class="ttdeci">void generate_convolution_kernel_wproj(double input_w_value, const arma::Col&lt; real_t &gt; &amp;aa_kernel_img)</div><div class="ttdoc">Generate convolution kernel at oversampled-pixel offsets for W-Projection. </div><div class="ttdef"><b>Definition:</b> aw_projection.cpp:131</div></div>
<div class="ttc" id="classstp_1_1_wide_field_imaging_html_a99e16ca0726a77ff2a43692b79372ab0"><div class="ttname"><a href="classstp_1_1_wide_field_imaging.html#a99e16ca0726a77ff2a43692b79372ab0">stp::WideFieldImaging::generate_convolution_kernel_aproj</a></div><div class="ttdeci">void generate_convolution_kernel_aproj(const arma::Mat&lt; real_t &gt; &amp;a_kernel_img)</div><div class="ttdoc">Generate convolution kernel at oversampled-pixel offsets for A-Projection. </div><div class="ttdef"><b>Definition:</b> aw_projection.cpp:57</div></div>
<div class="ttc" id="classstp_1_1_wide_field_imaging_html"><div class="ttname"><a href="classstp_1_1_wide_field_imaging.html">stp::WideFieldImaging</a></div><div class="ttdoc">The WideFieldImaging class. </div><div class="ttdef"><b>Definition:</b> aw_projection.h:21</div></div>
<div class="ttc" id="classstp_1_1_wide_field_imaging_html_a37802e179aff6ceae21e35312189b0a6"><div class="ttname"><a href="classstp_1_1_wide_field_imaging.html#a37802e179aff6ceae21e35312189b0a6">stp::WideFieldImaging::generate_combined_w_aa_kernel</a></div><div class="ttdeci">void generate_combined_w_aa_kernel(double input_w_value, const arma::Col&lt; real_t &gt; &amp;aa_kernel_img)</div><div class="ttdoc">Generate combined W-AA kernel (does not perform Fourier Transform). </div><div class="ttdef"><b>Definition:</b> aw_projection.cpp:48</div></div>
<div class="ttc" id="classstp_1_1_wide_field_imaging_html_ae9b3feaed0c11ecc7f5ae2bf08f7b248"><div class="ttname"><a href="classstp_1_1_wide_field_imaging.html#ae9b3feaed0c11ecc7f5ae2bf08f7b248">stp::WideFieldImaging::get_trunc_conv_support</a></div><div class="ttdeci">int get_trunc_conv_support()</div><div class="ttdoc">Get kernel truncation value in pixels. </div><div class="ttdef"><b>Definition:</b> aw_projection.h:76</div></div>
<div class="ttc" id="namespacestp_html"><div class="ttname"><a href="namespacestp.html">stp</a></div><div class="ttdef"><b>Definition:</b> ccl.cpp:17</div></div>
<div class="ttc" id="classstp_1_1_wide_field_imaging_html_a2b66dc0148b8e66f4fa03d7726fb75aa"><div class="ttname"><a href="classstp_1_1_wide_field_imaging.html#a2b66dc0148b8e66f4fa03d7726fb75aa">stp::WideFieldImaging::WideFieldImaging</a></div><div class="ttdeci">WideFieldImaging()=default</div><div class="ttdoc">Default constructor. </div></div>
<div class="ttc" id="types_8h_html_ab46614359717672dc9a4eed4669be6e6"><div class="ttname"><a href="types_8h.html#ab46614359717672dc9a4eed4669be6e6">real_t</a></div><div class="ttdeci">double real_t</div><div class="ttdef"><b>Definition:</b> types.h:17</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
